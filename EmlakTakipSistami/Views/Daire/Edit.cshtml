@model EmlakTakipSistami.Models.Daire

<div class="card shadow-lg mt-4 rounded-3">
    <div class="card-header bg-gradient-primary text-white">
        <h4><i class="fas fa-building"></i> Daire Düzenle</h4>
    </div>
    <div class="card-body">
        <form asp-action="Edit" method="post">
            <input type="hidden" asp-for="Id" />

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label">Kira Ücreti</label>
                    <div class="input-group">
                        <span class="input-group-text">₺</span>
                        <input asp-for="KiraUcreti" class="form-control" type="number" step="0.01" placeholder="Örn: 1500" />
                    </div>
                    <span asp-validation-for="KiraUcreti" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label class="form-label">İl</label>
                    <select id="il" name="Il" class="form-select form-select-lg"></select>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label">İlçe</label>
                    <select id="ilce" name="Ilce" class="form-select form-select-lg"></select>
                </div>
            </div>

            <div class="mt-4 d-flex gap-2">
                <button type="submit" class="btn btn-success btn-lg">
                    <i class="fas fa-save"></i> Kaydet
                </button>
                <a asp-action="Index" class="btn btn-outline-secondary btn-lg">
                    <i class="fas fa-arrow-left"></i> İptal
                </a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        var iller = @Html.Raw(ViewBag.IlcelerJson);
        var seciliIl = '@(Model?.Il ?? "")';
        var seciliIlce = '@(Model?.Ilce ?? "")';

        var ilSelect = document.getElementById("il");
        var ilceSelect = document.getElementById("ilce");

        // İl dropdownunu doldur
        Object.keys(iller).forEach(function(il){
            var option = document.createElement("option");
            option.value = il;
            option.text = il;
            if(il === seciliIl) option.selected = true;
            ilSelect.add(option);
        });

        // İlçe dropdownunu doldur
        function fillIlce(il){
            ilceSelect.innerHTML = "";
            if(iller[il]){
                iller[il].forEach(function(ilce){
                    var option = document.createElement("option");
                    option.value = ilce;
                    option.text = ilce;
                    if(ilce === seciliIlce) option.selected = true;
                    ilceSelect.add(option);
                });
            }
        }

        fillIlce(seciliIl);

        ilSelect.addEventListener("change", function(){
            fillIlce(this.value);
        });
    </script>
}
